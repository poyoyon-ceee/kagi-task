# プロジェクト引き継ぎサマリー (Handoff Summary)

作成日: 2026-01-16
バージョン: dev1.0.0.20260116.1
プロジェクト名: 鍵取替管理 (KeyExchange Manager)

## 1. プロジェクトの概要
Google Apps Script (GAS) と Googleスプレッドシートをバックエンドに利用した、スマホ対応の鍵取替作業管理アプリ。
Googleアカウントなしの外部共有者でも、Web App URLからアクセスして案件の登録・更新を行うことができる。

## 2. 現在のステータス
基本機能（CRUD）の実装が完了し、ユーザーによる実運用に向けた微調整を行っている段階。

### 実装済み機能
- **三段階ステータス管理**: 「新規」「進行中」「完了」のタブ切り替え。
- **マスタ管理 (Config)**: `config` シートから「地区」と「担当者」を読み込む仕組み（初回起動時のみ読込）。
- **楽観的UI更新**: 保存ボタンを押した瞬間に画面を更新し、通信待ちを感じさせない高速な操作感。
- **自動採番**: 受付番号とIDをスプレッドシートから自動計算。
- **ソート機能**: 受付番号（新着順/古い順）および地区順での並び替え。
- **バリデーション**: 「進行中」から保存する際の「完了報告者」選択を必須化。
- **鍵情報表示**: カード一覧および詳細画面での「玄関新品/中古」「物置」「PS」データの表示。

## 3. スプレッドシートの構成
- **SHEET_ID**: `1ZFpJtweMHXH6zUHM10NQxchkvb_dif2WClbYcybzsiw`
- **main シート**: 案件データ（A列:ID, B列:受付番号 ... L列:MMS受取日, M列:完了報告者, N列:完了報告日）。
- **config シート**: 選択肢マスタ（A列:地区名, B列:担当者名）。

## 4. 今後の検討事項 (Q&A履歴)
### 写真添付機能について
- **実現可能性**: 高い。
- **仕組み**: スマホカメラ起動 → Base64変換送信 → GAS経由でGoogleドライブ保存 → URLをスプレッドシートに記録。
- **アカウントなしの対応**: 
    - GASの実行権限を「自分（開発者）」にしているため可能。
    - ドライブのフォルダを「リンクを知る全員が閲覧可能」に設定することで表示も可能。
- **注意点**: セキュリティリスク（URLを知る全員が画像を見れる状態になる）への理解が必要。

## 5. 次回作業への指示
- この `docs/handoff/summary.md` を読み込み、`src/gas/Code.gs` および `src/gas/Index.html` のソースコードを確認すること。
- 写真添付機能の要望があった場合は、上記「仕組み」に則って実装を進めること。
